
<!DOCTYPE html>
<html lang="en">
<head>
	<title>Trudo</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/gamestyle.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
	<div id="turn">
	 	<h1 class="heading">Please rotate your device!</h1>
 </div>
	<div id="game-container">
	<div id="info">	</div>

	<!-- for showing player names -->
	<div id="p1"></div>
	<div id="p2"></div>
    <div id="p3"></div>

    <!-- for view button -->
    <div class="btn-group" id="btnview">
            <button type="button" style="background: black;" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
              <span class="glyphicon glyphicon-eye-open"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
              <li ><a href="#" id="sideview">Side View</a></li>
              <li><a href="#" id="topview">Top View</a></li>
              <li><a href="#" id="cornerview">Corner View</a></li>
            </ul>
          </div>
    <!-- view button ends -->


	<!-- for showing player names ends -->

    <!-- game over popup -->
    <div class="modal game-over" id="gameover" role="dialog">
        <div class="modal-dialog modal-lg" >
        <div class="modal-content" style="width: 100%;height: -webkit-fill-available;">
        <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"></button>
        <h4 class="modal-title">Game Over</h4>
        </div>
    <center>
        <div class="modal-body">
        <p><b>Thanks for playing!</b></p>
        </div>
    </center>

        <div class="modal-footer">
            <center><a href="index.html" class="btn btn-info btn-lg" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span>play Again</a>
        </div></center>
        </div>
        </div>
        </div>
	  <!-- sounds buttons starts -->
	  <div class="sound-btn" style="position: fixed;">
		<button type="button" class="btn btn-info btn-lg" onclick="play()"><span class="glyphicon glyphicon-play"></span> </button>
		<button type="button" class="btn btn-info btn-lg" onclick="pause()"><span class="glyphicon glyphicon-pause"></span> </button>
		</div>
	  <!-- sounds buttons ends -->

		  <audio id="audio" src="media\sounds\bgmusic.mp3" ></audio>
	</div>
</body>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<script type="text/javascript" src="js/zepto.js"></script>
	<script type="text/javascript" src="js/three.js"></script>
	<script type="text/javascript" src="js/OrbitControls.js"></script>
	<script src="js/OBJLoader.js"></script>
	<script src="js/DDSLoader.js"></script>
	<script src="js/GLTFLoader.js"></script>


<script >
function play() {
    var audio = document.getElementById("audio");
    audio.play();
	}
function pause() {
    var audio = document.getElementById("audio");
    audio.pause();
	}
</script>

<script type="module">
import * as THREE from './js/threejs-core/three.module.js';
import { GLTFLoader } from './js/threejs-core/GLTFLoader.js';
import { OrbitControls } from './js/threejs-core/OrbitControls.js';

var container, clock, mixer,mixer1,mixer2, actions, activeAction, previousAction;
var camera, scene, renderer, model,dicecolor=1, model1, model2,mixer22, num, firstchance = true, check = 1, controls, plane1;
var flag = false;
var flag1 = false;
var flag2 = false;
var totalSteps1 = 0;
var totalSteps2 = 0;
var totalSteps3 = 0;
var targetRotation = 0;
var targetRotationX = 0;
var x1, x2, x3, y1, y2, y3, z1, z2, z3;
x1 = 0, y1 = 0.8, z1 = -43;
x2 = 38.3, y2 = 0.8, z2 = 28;
x3 = -38.3, y3 = 0.8, z3 = 28;
var gameover = document.getElementById("gameover");
var die;

// var m=20,n=-10;
var api = { state: 'Walking' };
var modelbase = new THREE.RingBufferGeometry(3, 4, 8);
var basematerial = new THREE.MeshStandardMaterial({ color: "white" });
var circlebase = new THREE.Mesh(modelbase, basematerial);

circlebase.rotation.x = -Math.PI / 2;


init();
animate();
function init() {
    container = document.createElement('div');
    document.body.appendChild(container);
    camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.25, 2000);

    // camera.position.set(-80, 45,55);
    // camera.position.set(0, 100,30);
    camera.position.set(1, 35, 75);

    $(document).ready(function(){
        $("#topview").click(function(){

            camera.position.set(0, 100,30);
        });
        $("#sideview").click(function(){

            camera.position.set(1, 35, 75);
        });
        $("#cornerview").click(function(){

            camera.position.set(-80, 45,55);
        });
    });

    camera.lookAt(new THREE.Vector3(0, 2, 0));
    scene = new THREE.Scene();
    scene.background = new THREE.Color(0xe0e0e0);

    clock = new THREE.Clock();
    controls = new OrbitControls(camera);
    controls.enableRotate=false;
    controls.enableZoom=false;

    // lights
    var light = new THREE.HemisphereLight( 0xffffbb, 0x080820, 1);
    light.position.set(0, 20, 0);
    scene.add(light);
    light = new THREE.DirectionalLight(0xffffff);
    light.position.set(0, 20, 10);
    scene.add(light);
    // ground
    var mesh = new THREE.Mesh(new THREE.PlaneBufferGeometry(2000, 2000), new THREE.MeshPhongMaterial({ color: 0x999999, depthWrite: false }));
    mesh.rotation.x = - Math.PI / 2;
    scene.add(mesh);
    var grid = new THREE.GridHelper(60, 15, 'red', 'blue');
    grid.material.opacity = 0.8;
    grid.material.transparent = false;
    // scene.add(grid);
    //dice geometry
    playerDice(1);
    // dice function

	// for declaring first chance
    if (firstchance) {
        scene.add(circlebase);
        circlebase.position.set(0, 2, -43);
        firstchance = false;
	}

    workenvironment();
    modelloader(0, 0.8, -43, 1);
    modelloader3(-38.3, 0.8, 28, 3);
    modelloader2(38.3, 0.8, 28, 2);
    renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setPixelRatio(window.devicePixelRatio);
    renderer.setSize(window.innerWidth, window.innerHeight);
    container.appendChild(renderer.domElement);
    window.addEventListener('resize', onWindowResize, false);

}
// init ends


// events for dice click
$(document).ready(function () {
	// for dice click
    $("canvas").on('click', function(e){
		aRoll();


	// for checking chance
       switch (check) {
            case 1: {
                playerDice(1);
                ModelActive1();
                setTimeout(function () {
                modelplacecheck1();
                modal1PlaceKiller();
                chanceSet2();

                check++;

                console.log("case1active");
                if (totalSteps2 >= 43) {
                    check = 3;
                    chanceSet3();
                }
                dicecolor=check;
            },200*num);
                break;
            }
            case 2: {
                playerDice(2);
                ModelActive2();
                setTimeout(function () {
                modelplacecheck2();
                modal2PlaceKiller();
                chanceSet3();
                check++;
                console.log("case2active");
                if (totalSteps3 >= 43) {
                    check = 1;
                    chanceSet1();
                }
                dicecolor=check;
            },200*num);
                break;
            }
            case 3: {
                playerDice(3);
                ModelActive3();
                setTimeout(function () {
                modelplacecheck3();
                modal3PlaceKiller();
                chanceSet1();
                check = 1;
                if (totalSteps1 >= 43) {
                    check = 2;
                    chanceSet2();
                }
                dicecolor=check;
                console.log("case3active");
                },200*num);
                break;
            }

		}
		// for checking chance enda

   });
});
// events for dice click ends

function ModalAction1() {
    // mixer22=new THREE.AnimationMixer( model );

    if (x1 >= 0 && z1 < 28) {
        x1 = x1 + 2.3;
        z1 = z1 + 4.5;
        model.position.set(x1, y1, z1);
        console.log("x1=" + x1 + ",y1=" + y1 + ",z1=" + z1);

    }
    else if (x1 > -32.2 && z1 == 28) {
        x1 -= 4.6; console.log(x1 + "," + y1 + "," + z1);
        model.position.set(x1, y1, z1);
        model.lookAt(-31.6, 0, 28);
        console.log("x1=" + x1 + ",y1=" + y1 + ",z1=" + z1);

    }
    else if (x1 <= 0 && z1 <= 28) {
        x1 = x1 + 2.3;
        z1 = z1 - 4.5;
        model.position.set(x1, y1, z1);
        model.lookAt(0, 0, -35);
        console.log("x1=" + x1 + ",y1=" + y1 + ",z1=" + z1);

    }


}
function ModalAction2() {
    if (x2 >= 0 && z2 < 28) {
        x2 = x2 + 2.3;
        z2 = z2 + 4.5;
        model1.position.set(x2, y2, z2);
        model.lookAt(0, 0, 0);
        console.log("x2=" + x2 + ",y2=" + y2 + ",z2=" + z2);
    }
    else if (x2 > -32.2 && z2 == 28) {
        x2 -= 4.6;
        model1.position.set(x2, y2, z2); console.log(x2 + "," + y2 + "," + z2);
        model1.lookAt(0, 0, -35);
        console.log("x2=" + x2 + ",y2=" + y2 + ",z2=" + z2);
    }
    else if (x2 <= 0 && z2 <= 28) {
        x2 = x2 + 2.3;
        z2 = z2 - 4.5;
        model1.position.set(x2, y2, z2);
        model1.lookAt(31, 0, 28);
        console.log("x2=" + x2 + ",y2=" + y2 + ",z2=" + z2);
    }
}
function ModalAction3() {
    if (x3 >= 0 && z3 < 28) {
        x3 = x3 + 2.3;
        z3 = z3 + 4.5;
        model2.position.set(x3, y3, z3);
        console.log("x3=" + x3 + ",y3=" + y3 + ",z3=" + z3);
    }
    else if (x3 > -32.2 && z3 == 28) {
        x3 -= 4.6;
        model2.position.set(x3, y3, z3);
        console.log("x3=" + x3 + ",y3=" + y3 + ",z3=" + z3);
    }
    else if (x3 <= 0 && z3 <= 28) {
        x3 = x3 + 2.3;
        z3 = z3 - 4.5;
        model2.position.set(x3, y3, z3);
        console.log("x3=" + x3 + ",y3=" + y3 + ",z3=" + z3);
    }
}

function fadeToAction(name, duration) {
    previousAction = activeAction;
    activeAction = actions[name];
    if (previousAction !== activeAction) {
        previousAction.fadeOut(duration);
    }
    activeAction
        .reset()
        .setEffectiveTimeScale(1)
        .setEffectiveWeight(1)
        .fadeIn(duration)
        .play();
}
function onWindowResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
}
// animate function starts
function animate() {
    var dt = clock.getDelta();
    renderDice();
    circlebase.rotation.z += -.05;
    if (mixer) mixer.update(dt);
    if (mixer1) mixer1.update(dt);
    if (mixer2) mixer2.update(dt);
    if (mixer22) mixer22.update(dt);
    requestAnimationFrame(animate);
    controls.update();

    renderer.render(scene, camera);
}
// animate function ends

// modelloader starts for loading three different modules
function modelloader(a, b, c, position) {
    // model
    var loader = new GLTFLoader();
    loader.load('media/RobotExpressive/RobotExpressive.gltf', function (gltf) {
        if (position == 1) {
            model = gltf.scene;
            mixer = new THREE.AnimationMixer( model );
			mixer.clipAction( gltf.animations[4] ).setDuration( 3 ).play();
            model.position.set(a, b, c);
            model.lookAt(0, 0, 0);
            x1 = a; y1 = b; z1 = c;
            scene.add(model);
        }
    }, undefined, function (e) {
        console.error(e);
    });

}
function modelloader2(a, b, c, position) {
    var loader = new GLTFLoader();
    loader.load('media/RobotExpressive/RoboticExpressiveBlue.gltf', function (gltf) {

        if (position == 2) {
            model1 = gltf.scene;
            mixer1 = new THREE.AnimationMixer( model1 );
			mixer1.clipAction( gltf.animations[4] ).setDuration( 3 ).play();
            model1.position.set(a, b, c);
            model1.lookAt(0, 0, 0);
            x2 = a; y2 = b; z2 = c;
            scene.add(model1);
        }
    }, undefined, function (e) {
        console.error(e);

    });

}
function modelloader3(a, b, c, position) {
    var loader = new GLTFLoader();
    loader.load('media/RobotExpressive/RobotExpressiveRed.gltf', function (gltf) {

        if (position == 3) {
            model2 = gltf.scene;
            mixer2 = new THREE.AnimationMixer( model2 );
			mixer2.clipAction( gltf.animations[4] ).setDuration( 3 ).play();
            model2.position.set(a, b, c);
            model2.lookAt(0, 0, 0);
            x3 = a; y3 = b; z3 = c;
            scene.add(model2);
        }
    }, undefined, function (e) {
        console.error(e);

    });

}
// modelloader ends

//  for activate players/models
function ModelActive1() {
    for (var n = 1; n <= num; n++) {
        (function (n) {
        setTimeout(function () {

        if (num == 1 && flag == false && totalSteps1 == 0) {
            flag = true;
            jumpsound();
            console.log("first cehk");
            x1 = 0; y1 = 0.8; z1 = -35; console.log("Z=" + z1);
            model.position.set(x1, y1, z1);
            totalSteps1++;


        }
        else if (flag == true && totalSteps1 != 43) {
            // mixer22.clipAction( gltf.animations[6] ).setDuration( 3 ).play();
            jumpsound();
            ModalAction1();
            totalSteps1++;
            if (totalSteps1 == 43 && totalSteps1 > totalSteps3 && totalSteps1 > totalSteps2) {
                // alert("1st Winner:: Model 1");

                model.position.set(0, 0.8, -43);
                x1 = 0; y1 = 0.8; z1 = -43;
                // scene.remove(model);
            }
            if (totalSteps1 == 43 && (totalSteps2 == 43 || totalSteps3 == 43)) {
                x1 = 0; y1 = 0.8; z1 = -43;
                // alert("2nd Winner:: Model 1");
                gameover.style.display="block";
            }


        }
    }, 190*n);
  })(n);

    }

}
function ModelActive2() {
    for (var n = 1; n <= num; n++) {
        (function (n) {
        setTimeout(function () {

        if (num == 1 && flag1 == false && totalSteps2 == 0) {
            flag1 = true;
            jumpsound();
            x2 = 32.2; y2 = 0.8; z2 = 28;
            model1.position.set(x2, y2, z2);
            totalSteps2++;


        }
        else if (flag1 == true && totalSteps2 != 43) {
            jumpsound();
            ModalAction2();
            totalSteps2++;
            if (totalSteps2 == 43 && totalSteps2 > totalSteps1 && totalSteps2 > totalSteps3) {
                model1.position.set(38.3, 0.8, 28);
                x2 = 38.3; y2 = 0.8; z2 = 28;
                alert("1st Winner::" + ' ' + pro2);
            }
            if (totalSteps2 == 43 && (totalSteps1 == 43 || totalSteps3 == 43)) {
                model1.position.set(38.3, 0.8, 28);
                x2 = 38.3; y2 = 0.8; z2 = 28;
                alert("2nd Winner::" + ' ' + pro2);
                gameover.style.display="block";
            }
        }
    }, 190*n);
  })(n);

    }

}

function ModelActive3() {

    for (var n = 1; n <= num; n++) {
        (function (n) {
        setTimeout(function () {

        if (num == 1 && flag2 == false && totalSteps3 == 0) {
            flag2 = true;
            jumpsound();
            x3 = -32.2; y3 = 0.8; z3 = 28;
            model2.position.set(x3, y3, z3);
            console.log(model2.position);
            totalSteps3++;

        }
        else if (flag2 == true && totalSteps3 != 43) {
            jumpsound();
            ModalAction3();
            totalSteps3++;
            if (totalSteps3 == 43 && totalSteps3 > totalSteps1 && totalSteps3 > totalSteps2) {
                model2.position.set(-38.3, 0.8, 28);
                x3 = -38.3; y3 = 0.8; z3 = 28;
                alert("1st Winner::" + ' ' + pro3);

            }
            if (totalSteps3 == 43 && (totalSteps1 == 43 || totalSteps2 == 43)) {
                x3 = -38.3; y3 = 0.8; z3 = 28;
                alert("2nd Winner::" + ' ' + pro3);

                gameover.style.display="block";
            }

        }
    }, 190*n);
  })(n);
    }

}
//  for activate players/models ends

// for checking th killing place of others
function modelplacecheck1() {
    if (Math.floor(x1) == Math.floor(x2) && y1 == y2 && z1 == z2 && Math.ceil(x1)!=-16 && z1 != -3.5) {
        x2 = 38.3; y2 = 0.8; z2 = 28;
       model1.position.set(x2, y2, z2);
        console.log("model-2 killed");
        alert(pro2 + "Killed");
        flag1 = false;

        totalSteps2 = 0;
    }
    if (Math.floor(x1) == Math.floor(x3) && y1 == y3 && z1 == z3&&(Math.floor(x1) != 16 && z1 != -3.5)) {
        x3 = -38.3; y3 = 0.8; z3 = 28;
         model2.position.set(x3, y3, z3);
        console.log("model-3 killed");
        alert(pro3 + "Killed");
        flag2 = false;

        totalSteps3 = 0;
    }
}
function modelplacecheck2() {
    if (Math.floor(x2) == Math.floor(x1) && y2 == y1 && z2 == z1&&(Math.floor(x2) != 0 || z2 != 28)) {
        x1 = 0; y1 = 0.8; z1 = -43;
        model.position.set(x1, y1, z1);
        console.log("model-1 killed");
        alert(pro1 + "Killed");
        flag = false;

        totalSteps1 = 0;
    }
    if (Math.floor(x2) == Math.floor(x3) && y2 == y3 && z2 == z3 && (Math.floor(x2) != 16 &&  z2 != -3.5)) {
        x3 = -38.3; y3 = 0.8; z3 = 28;
        model2.position.set(x3, y3, z3);
        console.log("model-3 killed");
        alert(pro3 + "Killed");
        flag2 = false;
        totalSteps3 = 0;
    }
}
function modelplacecheck3() {
    if (Math.floor(x3) == Math.floor(x2) && y3 == y2 && z3 == z2&&(Math.ceil(x3) != -16 && z3 != -3.5)) {
        x2 = 38.3; y2 = 0.8; z2 = 28;
        model1.position.set(x2, y2, z2);
        console.log("model-2 killed");
        alert(pro2 + "Killed");
        flag1 = false;

        totalSteps2 = 0;
    }
    if (Math.floor(x3) == Math.floor(x1) && y3 == y1 && z3 == z1&&(Math.floor(x3) != 0 && z3 != 28)) {
        x1 = 0; y1 = 0.8; z1 = -43;
         model.position.set(x1, y1, z1);
        console.log("model-1 killed");
        alert(pro1 + " Killed");
        flag = false;
        totalSteps1 = 0;
    }
}
// for checking the killing place of others ends

// safe position checker starts
function modal1PlaceKiller() {
    if ((Math.floor(x1) == 16 && y1 == 0.8 && z1 == -3.5) || (Math.ceil(x1) == -16 && y1 == 0.8 && z1 == -3.5)) {
        x1 = 0; y1 = 0.8; z1 = -43;
        model.position.set(x1, y1, z1);
        console.log("model-1 killed");
        alert(pro1 + "Killed");
        flag = false;
        totalSteps1 = 0;
    }
}
function modal2PlaceKiller() {
    if ((Math.floor(x2) == 0 && y2 == 0.8 && z2 == 28) || (Math.floor(x2) == 16 && y2 == 0.8 && z2 == -3.5)) {
        x2 = 38.3; y2 = 0.8; z2 = 28;
         model1.position.set(x2, y2, z2);
        console.log("model-2 killed");
        alert(pro2 + "Killed");
        flag1 = false;

        totalSteps2 = 0;
    }
}
function modal3PlaceKiller() {
    if ((Math.ceil(x3) == -16 && y3 == 0.8 && z3 == -3.5) || (Math.floor(x3) == 0 && y3 == 0.8 && z3 == 28)) {
        x3 = -38.3; y3 = 0.8; z3 = 28;
         model2.position.set(x3, y3, z3);
        console.log("model-3 killed");
        alert(pro3 + "Killed");
        flag2 = false;
        totalSteps3 = 0;
    }
}
// safe position checker ends

// swaping chance of players
function chanceSet1() {
    scene.remove(circlebase);
    scene.add(circlebase);
    circlebase.position.set(x1, 2, z1);
}
function chanceSet2() {
    scene.remove(circlebase);
    scene.add(circlebase);
    circlebase.position.set(x2, 2, z2);
}
function chanceSet3() {
    scene.remove(circlebase);
    scene.add(circlebase);
    circlebase.position.set(x3, 2, z3);
}
// swaping ends

// for creating UI platform
function workenvironment() {

    // triangle starts
 var triangle = new THREE.Geometry();
    triangle.vertices.push(new THREE.Vector3(0, -0.5, -40));
    triangle.vertices.push(new THREE.Vector3(-35, -0.5, 30));
    triangle.vertices.push(new THREE.Vector3(35, -0.5, 30));


    //create a new face using vertices 0, 1, 2
    var normal = new THREE.Vector3(0, 1, 0); //optional
    var color = new THREE.Color(0xffaa00); //optional
    var materialIndex = 0; //optional
    var face = new THREE.Face3(0, 1, 2, normal, color, materialIndex);

    //add the face to the geometry's faces array
    triangle.faces.push(face);
    //the face normals and vertex normals can be calculated automatically if not supplied above
    triangle.computeFaceNormals();
    triangle.computeVertexNormals();
    var Trianglematerial = new THREE.MeshBasicMaterial({ color: 'grey' });
    var tri1 = new THREE.Mesh(triangle, Trianglematerial);
    scene.add(tri1);
    tri1.position.set(0, 0, 0);
    var mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    var triangle1 = new THREE.Geometry();
    triangle1.vertices.push(new THREE.Vector3(0, -0.5, -10));
    triangle1.vertices.push(new THREE.Vector3(-5, -0.5, 0));
    triangle1.vertices.push(new THREE.Vector3(5, -0.5, 0));

    //create a new face using vertices 0, 1, 2
    var normal1 = new THREE.Vector3(0, 1, 0); //optional
    var color1 = new THREE.Color(0xffaa00); //optional
    var materialIndex1 = 0; //optional
    var face1 = new THREE.Face3(0, 1, 2, normal1, color1, materialIndex1);

    //add the face to the geometry's faces array
    triangle1.faces.push(face);
    //the face normals and vertex normals can be calculated automatically if not supplied above
    triangle1.computeFaceNormals();
    triangle1.computeVertexNormals();
    var Trianglematerial1 = new THREE.MeshBasicMaterial({ color: 'red' });
    var tri2 = new THREE.Mesh(triangle1, Trianglematerial1);

    // scene.add(tri2);
    tri2.position.set(-38.3, 0, 33.3);
    var triangle2 = new THREE.Geometry();
    triangle2.vertices.push(new THREE.Vector3(0, -0.5, -10));
    triangle2.vertices.push(new THREE.Vector3(-5, -0.5, 0));
    triangle2.vertices.push(new THREE.Vector3(5, -0.5, 0));

    //create a new face using vertices 0, 1, 2
    var normal2 = new THREE.Vector3(0, 1, 0); //optional
    var color2 = new THREE.Color(0xffaa00); //optional
    var materialIndex2 = 0; //optional
    var face2 = new THREE.Face3(0, 1, 2, normal2, color2, materialIndex2);

    //add the face to the geometry's faces array
    triangle2.faces.push(face);
    //the face normals and vertex normals can be calculated automatically if not supplied above
    triangle2.computeFaceNormals();
    triangle2.computeVertexNormals();
    var Trianglematerial2 = new THREE.MeshBasicMaterial({ color: 'blue' });
    var tri3 = new THREE.Mesh(triangle2, Trianglematerial2);

    // scene.add(tri3);
    tri3.position.set(38.3, 0, 33.3);

	var triangle3 = new THREE.Geometry();
    triangle3.vertices.push(new THREE.Vector3(0, -0.5, -10));
    triangle3.vertices.push(new THREE.Vector3(-5, -0.5, 0));
    triangle3.vertices.push(new THREE.Vector3(5, -0.5, 0));

    //create a new face using vertices 0, 1, 2
    var normal3 = new THREE.Vector3(0, 1, 0); //optional
    var color3 = new THREE.Color(0xffaa00); //optional
    var materialIndex3 = 0; //optional
    var face3 = new THREE.Face3(0, 1, 2, normal3, color3, materialIndex3);

    //add the face to the geometry's faces array
    triangle3.faces.push(face);
    //the face normals and vertex normals can be calculated automatically if not supplied above
    triangle3.computeFaceNormals();
    triangle3.computeVertexNormals();
    var Trianglematerial3 = new THREE.MeshBasicMaterial({ color: 'yellow' });
    var tri4 = new THREE.Mesh(triangle3, Trianglematerial3);
    // scene.add(tri4);
    tri4.position.set(0, 0, -40);

    var colorgeo = new THREE.BoxBufferGeometry(4.5, 1.5, 4.5);
    var colormat = new THREE.MeshStandardMaterial({ color: 'red' });
    var blue = new THREE.Mesh(colorgeo, colormat);
    blue.position.set(-38.3, 0, 29);
    scene.add(blue);

    var colorgeo1 = new THREE.BoxBufferGeometry(4.5, 1.5, 4.5);
    var colormat1 = new THREE.MeshStandardMaterial({ color: 'blue' });
    var red = new THREE.Mesh(colorgeo1, colormat1);
    red.position.set(38.3, 0, 29);
    scene.add(red);

    var colorgeo2 = new THREE.BoxBufferGeometry(4.5, 1.5, 4.5);
    var colormat2 = new THREE.MeshStandardMaterial({ color: 'yellow' });
    var yellow = new THREE.Mesh(colorgeo2, colormat2);
    yellow.position.set(0, 0, -43);
    scene.add(yellow);
   // triangle ends

    //Whole plateform of game
    var geometry = new THREE.BoxBufferGeometry(4, 1.5, 4);
    var material = new THREE.MeshStandardMaterial({ color: '#241c13' });
    var materialpos1 = new THREE.MeshStandardMaterial({ color: 'yellow' });
    var materialpos2 = new THREE.MeshStandardMaterial({ color: 'blue' });
    var materialpos3 = new THREE.MeshStandardMaterial({ color: 'red' });
    var cube = new THREE.Mesh(geometry, material);
    var cube1 = new THREE.Mesh(geometry, material);
    var cube2 = new THREE.Mesh(geometry, material);
    var cube11, cube22, cube33, stpos1, stpos2;
    var standingpos1 = new THREE.Mesh(geometry, materialpos1);
    var standingpos2 = new THREE.Mesh(geometry, materialpos2);
    var standingpos3 = new THREE.Mesh(geometry, materialpos3);
    var cornergeo1 = new THREE.BoxBufferGeometry(3, 1.5, 3);
    var cornermat1 = new THREE.MeshStandardMaterial({ color: '#241c13' });
    var corner1 = new THREE.Mesh(cornergeo1, cornermat1);
    corner1.position.set(-31.6, 0, 28);
    scene.add(corner1);
    var cornergeo2 = new THREE.BoxBufferGeometry(3, 1.5, 3);
    var cornermat2 = new THREE.MeshStandardMaterial({ color: '#241c13' });
    var corner2 = new THREE.Mesh(cornergeo2, cornermat2);
    corner2.position.set(31, 0, 28);
    scene.add(corner2);
    var cornergeo3 = new THREE.BoxBufferGeometry(3, 1.5, 3);
    var cornermat3 = new THREE.MeshStandardMaterial({ color: '#241c13' });
    var corner3 = new THREE.Mesh(cornergeo3, cornermat3);
    corner3.position.set(0, 0, -35);
    scene.add(corner3);

	// for generating path for playes
    for (var box = 1; box < 14; box++) {
        if (box == 7) {
            continue;
        }
        else {
            cube11 = cube.clone();
            cube22 = cube1.clone();
            cube33 = cube2.clone();
            scene.add(cube11);
            scene.add(cube22);
            scene.add(cube33);

            cube11.position.set(box * 2.3, 0, -35 + (4.5 * box));
            cube11.rotation.y = -Math.PI / 2.92;
            cube22.position.set(-box * 2.3, 0, -35 + (4.5 * box));
            cube22.rotation.y = Math.PI / 2.92;
            cube33.position.set(-31.5 + (4.5 * box), 0, 28);
        }
	}

    var stpos1 = standingpos1.clone();
    var stpos2 = standingpos2.clone();
    var stpos3 = standingpos3.clone();
    stpos1.position.set(0, 0, 28);
    stpos2.position.set(-16, 0, -3.7);
    stpos2.rotation.y = Math.PI / 2.92;
    stpos3.position.set(16, 0, -3.7);
    stpos3.rotation.y = -Math.PI / 2.92;
    scene.add(stpos1);
    scene.add(stpos2);
	scene.add(stpos3);
	// path generation ends

	// trying something
	var customsceneno = Math.floor(Math.random() * 2);
	if (customsceneno == "0"){
		var customscene ="skybox";
	}
	if (customsceneno == "1"){
		var customscene ="Park3Med";
	}





	// END Here



	// skybox for 360 view
    let materialArray = [];
		var customscene = ["Bridge2","Park2","Park3Med","skybox","SwedishRoyalCastle"];
		var customscene = customscene[Math.floor(Math.random()*customscene.length)];
		var texture_ft = new THREE.TextureLoader().load('media/images/scene/'+customscene+'/posx.jpg');
    var texture_bk = new THREE.TextureLoader().load('media/images/scene/'+customscene+'/negx.jpg');
    var texture_up = new THREE.TextureLoader().load('media/images/scene/'+customscene+'/posy.jpg');
    var texture_dn = new THREE.TextureLoader().load('media/images/scene/'+customscene+'/negy.jpg');
    var texture_rt = new THREE.TextureLoader().load('media/images/scene/'+customscene+'/posz.jpg');
    var texture_lf = new THREE.TextureLoader().load('media/images/scene/'+customscene+'/negz.jpg');

    materialArray.push(new THREE.MeshBasicMaterial({ map: texture_ft }));
    materialArray.push(new THREE.MeshBasicMaterial({ map: texture_bk }));
    materialArray.push(new THREE.MeshBasicMaterial({ map: texture_up }));
    materialArray.push(new THREE.MeshBasicMaterial({ map: texture_dn }));
    materialArray.push(new THREE.MeshBasicMaterial({ map: texture_rt }));
    materialArray.push(new THREE.MeshBasicMaterial({ map: texture_lf }));

    for (let i = 0; i < 6; i++)
        materialArray[i].side = THREE.BackSide;
    let skyboxGeo = new THREE.BoxGeometry(1000, 1000, 1000);
    let skybox = new THREE.Mesh(skyboxGeo, materialArray);
    scene.add(skybox);
    let light2 = new THREE.AmbientLight( 0x404040, ); // soft white light
// light2.position.set(0,10,0)
scene.add( light2 );
}
// skybox ends


// New Dice
function aRoll() {
//note: pi = 180
dicesound();
console.log('you clicked the roll button');
 num = Math.floor((Math.random()*6)+1);
console.log(num);

$('#log').append('<br>' + num);

switch (num) {
case 1:
targetRotation = Math.PI / 2;
targetRotationX = Math.PI/2;
break;
case 2:
targetRotation = Math.PI / 2;
targetRotationX = -1.5;
break;
case 3:
targetRotation = Math.PI ;
targetRotationX = Math.PI/16;
break;
case 4:
targetRotation = 0;
targetRotationX = -Math.PI ;
break;
case 5:
targetRotation = 0;
targetRotationX = -Math.PI/2;
break;
case 6:
targetRotation = Math.PI;
targetRotationX = -Math.PI/2;
break;
}
}

function renderDice() {
    plane1.rotation.y = die.rotation.y += (targetRotation - die.rotation.y) * .10;
    die.rotation.x += (targetRotationX - die.rotation.x) * 0.10;
    //die.rotation.y += ( targetRotationX - die.rotation.x ) * 0.05;
}
function playerDice(dicecolor) {
    var DiceMaterialRed = [];
var DiceMaterialBlue = [];
var DiceMaterialYellow = [];
// New Dice...

    // $(document).on('click', function(e){aRoll();});

    for (let i = 1; i < 7; i++) {
    DiceMaterialYellow.push(new THREE.MeshBasicMaterial({ map: THREE.ImageUtils.loadTexture('media/images/dice/yellow/' + i + '.png'), overdraw: true }));
    DiceMaterialBlue.push(new THREE.MeshBasicMaterial({ map: THREE.ImageUtils.loadTexture('media/images/dice/blue/' + i + '.png'), overdraw: true }));
    DiceMaterialRed.push(new THREE.MeshBasicMaterial({ map: THREE.ImageUtils.loadTexture('media/images/dice/red/' + i + '.png'), overdraw: true }));
    }
    switch(dicecolor){
        case 1:
        var dieMat = new THREE.MeshFaceMaterial(DiceMaterialYellow);
        scene.remove(plane1);
        scene.remove(die);
        break;
        case 2:
        var dieMat = new THREE.MeshFaceMaterial(DiceMaterialBlue);
        scene.remove(plane1);
        scene.remove(die);
        break;
        case 3:
        var dieMat = new THREE.MeshFaceMaterial(DiceMaterialRed);
        scene.remove(plane1);
        scene.remove(die);
        break;

    }
    // var dieMat = new THREE.MeshFaceMaterial(DiceMaterialYellow);
    var dieGeo = new THREE.CubeGeometry(5, 5, 5, 5, 5, 5);
    die = new THREE.Mesh(dieGeo, dieMat);
    die.position.set(0, 5, 0);
    scene.add(die);

    var geometry = new THREE.PlaneGeometry(5, 5);
    geometry.applyMatrix(new THREE.Matrix4().makeRotationX(- Math.PI / 2));


    var material = new THREE.MeshBasicMaterial({ color: '#241c13' });

    plane1 = new THREE.Mesh(geometry, material);
    plane1.position.y = 0;
	scene.add(plane1);
	// new dice added


}
function dicesound(){
    var listener = new THREE.AudioListener();
camera.add( listener );

// create a global audio source
var sound = new THREE.Audio( listener );

// load a sound and set it as the Audio object's buffer
var audioLoader = new THREE.AudioLoader();
audioLoader.load( 'media/sounds/dicesound.mp3', function( buffer ) {
	sound.setBuffer( buffer );
	sound.setLoop( false );
	sound.setVolume(1 );
	sound.play();
});

}
function jumpsound(){
    var listener2 = new THREE.AudioListener();
camera.add( listener2 );

// create a global audio source
var sound2 = new THREE.Audio( listener2 );

// load a sound and set it as the Audio object's buffer
var audioLoader = new THREE.AudioLoader();
audioLoader.load( 'media/sounds/jump.wav', function( buffer ) {
	sound2.setBuffer( buffer );
	sound2.setLoop( false );
	sound2.setVolume(0.8 );
	sound2.play();
});
}

</script>

<script>
	$(document).ready(function(){
		var profile1=document.getElementById("p1");
	    pro1=sessionStorage.getItem("Profile1");
		profile1.innerHTML="Player 1 " + "<br>" + pro1;

		var profile2=document.getElementById("p2");
	    pro2=sessionStorage.getItem("Profile2");
		profile2.innerHTML="Player 2 " + "<br>" + pro2;

		var profile3=document.getElementById("p3");
	    pro3=sessionStorage.getItem("Profile3");
		profile3.innerHTML="Player 3 " + "<br>" + pro3;
	   });

</script>



</html>
